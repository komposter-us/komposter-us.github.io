const UPDATE_OVERLAYED_CARD_STATUS=!1,AliveStatus={Unknown:0,Defended:1,Suspect:2,Crewmate:3,Imposter:4,Killed:5,Ejected:6},Misc={Round:0},g_oPhrases={ru:{misc:["Раунд"],statusShort:["?","К","Ч","М","И","У","В"],statusFull:["Неизвестный","Красный","Черный","Мирный","Импостер","Убит","Выброшен"]},en:{misc:["Round"],statusShort:["?","D","S","C","I","K","E"],statusFull:["Unknown","Defended","Suspect","Crewmate","Impostor","Killed","Ejected"]}},g_aCrewmateColor=["#C51111","#132ED1","#117F2D","#ED54BA","#EF7D0E","#F6F658","#3F474E","#D6E0F0","#6B31BC","#71491E","#38FEDB","#50EF39"],g_sLang="ru"===window.navigator.language.slice(0,2)?"ru":"en",getCssOverlayClass=t=>"overlay-"+g_oPhrases.en.statusFull[t].toLowerCase();let g_iRound=1;const btnRound=document.querySelector(".btn-round"),btnText=document.querySelector(".btn-round-num"),btnRoundText=document.querySelector(".btn-round-text");btnRoundText.textContent=g_oPhrases[g_sLang].misc[Misc.Round],btnRound.addEventListener("click",(function(){btnText.textContent=++g_iRound,onRoundBtnClick()}));const btnRestart=document.querySelector(".btn-restart");function createCards(){const t=document.querySelector(".card-containter");for(const[e,n]of g_aCrewmateColor.entries()){const s=document.createElement("div");s.classList.add("card-status-container"),createCardStatus(s,AliveStatus.Unknown);const a=document.createElement("div");a.classList.add("card-btn-container");for(let t=0;t<g_oPhrases[g_sLang].statusFull.length;t++){const n=document.createElement("button");n.classList.add("btn-status"),n.append(document.createTextNode(g_oPhrases[g_sLang].statusFull[t])),a.append(n),n.addEventListener("click",onStatusBtnClick.bind(n,e,t))}const o=document.createElement("div");o.classList.add("card"),o.style.backgroundColor=n;const c=document.createElement("button");c.classList.add("btn-close"),c.addEventListener("click",closeCard),o.append(c),o.append(s),o.append(a),t.append(o)}}function closeCard(){console.log("close card",this.parentElement),this.parentElement.classList.add("hidden")}function onStatusBtnClick(t,e){const n=this.parentElement.parentElement,s=n.querySelector(".card-status-container"),a=s.querySelectorAll("*").length;console.log(`onStatusBtnClick > Card: ${t}, status: ${e}, statusNums: ${a}`),a<g_iRound?createCardStatus(s,e):updateCardStatus(s.lastElementChild,e),e>AliveStatus.Suspect&&(console.log(`onStatusBtnClick > Card: ${t} add overlay`),n.classList.add(getCssOverlayClass(e)),n.querySelector(".btn-close").classList.add("btn-close-white"),setTimeout(()=>{n.addEventListener("click",()=>{console.log(`onStatusBtnClick > Card: ${t} Remove overlay`),n.classList.remove(getCssOverlayClass(e)),n.querySelector(".btn-close").classList.remove("btn-close-white"),setStatusContainerChildsVis(s,!1),updateStatusContainer(s)},{once:!0})},500))}function createCardStatus(t,e,n=!1){const s=document.createElement("div");s.classList.add("card-status"),s.dataset.status=e,updateCardStatus(s,e),t.append(s),n&&s.classList.add("invisible")}function updateCardStatus(t,e){t.innerHTML=g_oPhrases[g_sLang].statusShort[e],t.dataset.status=e,console.log("updateCardStatus >",t)}function onRoundBtnClick(){const t=document.querySelectorAll(".card-status-container");let e;for(const n of t)e=n.lastElementChild.dataset.status>AliveStatus.Suspect||n.lastElementChild.classList.contains("invisible"),e||n.querySelectorAll("*").length<g_iRound&&createCardStatus(n,AliveStatus.Unknown,!1)}function updateStatusContainer(t){let e=t.querySelectorAll("*").length;for(;e++<g_iRound;)createCardStatus(t,AliveStatus.Unknown)}function setStatusContainerChildsVis(t,e){const n=t.querySelectorAll("*");for(const t of n)e?t.classList.add("invisible"):t.classList.remove("invisible")}btnRestart.addEventListener("click",(function(){document.location.reload()})),createCards();